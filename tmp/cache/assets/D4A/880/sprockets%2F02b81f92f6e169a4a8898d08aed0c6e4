o: ActiveSupport::Cache::Entry	:@compressedF:@expires_in0:@created_atf1424791685.1542492:@value{	I"length:ETiò
I"digest;
TI"%31db4d6f940b0cb062f39032901ef158;
FI"source;
TI"ò
function MMIconsWidget(t){this.engine=t,this.searchEngineLinkContainers=null,this.currentXhr=null,this.bindListeners(),this.currentOfferIndex=0}MMIconsWidget.prototype.bindListeners=function(){var t=$.proxy(function(){this.isPopupVisible()&&this.setNextOffer(null)},this);$(".mm-popup-next-offer").click(t),isMobile()&&$(window).on("shake",t)},MMIconsWidget.prototype.isPopupVisible=function(){return 0==$("#mm-offer-modal").is(":hidden")},MMIconsWidget.prototype.setNextOffer=function(t){var e=this.engine.get("box","getCurrentData");this.currentOfferIndex=this.currentOfferIndex>e.length-1?0:this.currentOfferIndex;for(var i in e){var n="Search::SoleoMerchant"!=e[i].type&&"Search::LocalMerchant"!=e[i].type;if(n)if(t){if(t==e[i].company_name){this.setMerchantData(e[i]),this.currentOfferIndex=i;break}}else if(i>=this.currentOfferIndex){this.setMerchantData(e[i]),this.currentOfferIndex=i;break}}this.currentOfferIndex++},MMIconsWidget.prototype.setSearchEngineLinkContainers=function(t){this.searchEngineLinkContainers=t,this.engine.isUserLoggedIn&&null!=this.searchEngineLinkContainers&&(this.clearResults(),this.loadMerchantsByUrls())},MMIconsWidget.prototype.clearResults=function(){$(".mm-affiliate-icon").remove()},MMIconsWidget.prototype.loadMerchantsByUrls=function(){this.currentXhr&&this.currentXhr.abort();var t=[];this.searchEngineLinkContainers.each(function(){t.push($(this).find("a").attr("href"))});var e=this.engine.get("box","getSearchString");this.currentXhr=$.get(this.engine.urlFor("/mm_affiliate_merchants_search"),$.param({links:t,search:e}),$.proxy(function(t){this.onMerchantsByUrlsDataLoaded(t),this.currentXhr=null},this))},MMIconsWidget.prototype.onMerchantsByUrlsDataLoaded=function(t){for(var e=[],i=0;i<t.length;i++)t[i]&&(e.push(t[i]),this.insertMerchantIcon(i,t[i].company_name));this.engine.dispatch("appendData",e)},MMIconsWidget.prototype.setMerchantData=function(t){var e=$("#mm-offer-modal");for(var i in t)e.find(".mm_data_"+i).html(t[i]);e.find(".mm-popup-shop-now").attr("mm-href",t.offer_buy_url).attr("mm-merchant-id",t.id),"No coupons"!=t.coupon_code?(e.find(".mm_data_coupon_code").addClass("mm-active-link"),e.find(".mm-popup-shop-now, .mm_data_coupon_code").attr("mm-href-popup",t.company_coupons_url)):(e.find(".mm_data_coupon_code").removeClass("mm-active-link"),e.find(".mm-popup-shop-now, .mm_data_coupon_code").removeAttr("mm-href-popup"))},MMIconsWidget.prototype.insertMerchantIcon=function(t,e){var i=$("<div/>",{"class":"mm-affiliate-icon","data-toggle":"modal",href:"#mm-offer-modal"});$(this.searchEngineLinkContainers[t]).prepend(i),i.click($.proxy(function(){this.setNextOffer(e)},this))},MMIconsWidget.prototype.onUserLoggedOut=function(){this.currentXhr&&this.currentXhr.abort(),this.searchEngineLinkContainers=null,this.clearResults()};;
TI"_version;
TI"%7a400a34242855260a082d2f04e33ead;
F