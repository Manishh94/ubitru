/*
 * jQuery File Upload Image Processing Plugin 1.0.1
 * https://github.com/blueimp/jQuery-File-Upload
 *
 * Copyright 2012, Sebastian Tschan
 * https://blueimp.net
 *
 * Licensed under the MIT license:
 * http://www.opensource.org/licenses/MIT
 */
!function(t){"use strict";"function"==typeof define&&define.amd?define(["jquery","./load-image.js","./canvas-to-blob.js","./jquery.fileupload.js"],t):t(window.jQuery,window.loadImage,window.canvasToBlob)}(function(t,e,i){"use strict";t.widget("blueimpIP.fileupload",t.blueimp.fileupload,{options:{resizeSourceFileTypes:/^image\/(gif|jpeg|png)$/,resizeSourceMaxFileSize:2e7,resizeMaxWidth:void 0,resizeMaxHeight:void 0,resizeMinWidth:void 0,resizeMinHeight:void 0,add:function(e,i){t(this).fileupload("resize",i).done(function(){i.submit()})}},_resizeImage:function(n,s){var o,a=this,r=this.options,l=n[s],c=t.Deferred();return e(l,function(t){var h=t.width,u=t.height;o=e.scale(t,{maxWidth:r.resizeMaxWidth,maxHeight:r.resizeMaxHeight,minWidth:r.resizeMinWidth,minHeight:r.resizeMinHeight,canvas:!0}),h!==o.width||u!==o.height?i(o,function(t){t.name||(l.type===t.type?t.name=l.name:l.name&&(t.name=l.name.replace(/\..+$/,"."+t.type.substr(6)))),n[s]=t,c.resolveWith(a)},l):c.resolveWith(a)}),c.promise()},resize:function(e){var i=this,n=t.extend({},this.options,e),s="number"!==t.type(n.resizeSourceMaxFileSize);return t.each(e.files,function(o,a){i._resizeSupport&&(n.resizeMaxWidth||n.resizeMaxHeight||n.resizeMinWidth||n.resizeMinHeight)&&(s||a.size<n.resizeSourceMaxFileSize)&&n.resizeSourceFileTypes.test(a.type)&&(i._processing+=1,1===i._processing&&i.element.addClass("fileupload-processing"),i._processingQueue=i._processingQueue.pipe(function(){var n=t.Deferred();return i._resizeImage(e.files,o).done(function(){i._processing-=1,0===i._processing&&i.element.removeClass("fileupload-processing"),n.resolveWith(i)}),n.promise()}))}),this._processingQueue},_create:function(){t.blueimp.fileupload.prototype._create.call(this),this._processing=0,this._processingQueue=t.Deferred().resolveWith(this).promise(),this._resizeSupport=i(document.createElement("canvas"),t.noop)}})});